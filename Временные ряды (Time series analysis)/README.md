**Цель**: Создать модель прогнозирования сумм внесений за день на горизонт 14 дней.

**Описание:** 

Для разработки модели клиент прислал данные о внесениях донатов. 
Для лучшего планирования финансовых ресурсов клиент хочет иметь в контуре модель, которая будет прогнозировать внесения на две недели вперёд. 
На данный момент аналитики на стороне клиента прикидывают объёмы внесений на 14 дней вперед, основываясь на «средних внесениях за прошедший период». 
Все исторические данные, которые есть у клиента, содержатся в файле. Клиент не откладывал тестовую выборку для проверки модели. 

Датасет data.csv содержит логи о начислении пожертвований. Необходимо обработать данные и построить модель для прогнозирования сумм пожертвований по дням на горизонт 14 дней. 
В датасете содержится два поля: 
-	date_time - дата и время произведённой транзакции
-	cash - сумма зачисленная в результате транзакции. 


# Отчёт по решённой задаче

Перед нами нестационарный временной ряд. Было проверено, что дата и время расположены в хрологическом порядке. Отсутствующих значений в ряде нет. Для проверки стационарности был выполнен тест Дики Фуллера, где поставили нулевую гипотезу, что ряд имеет единичный корень (ряд не является стационарным) и альтернативную гипотезу, что ряд не имеет единичного корня (является стационарным). Получили **p-value:  0.012 < 0.05**, что вроде бы позволяет отвергнуть нулевую гипотезу, однако, такое утверждение не всегда справедливо. Вывод о том, что ряд станционарный определили после сглаживания скользящей средней с окном **30**. Стало нгаглядно видно, что график имеет убывающий тренд и непостоянную дисперсию.

В силу того, что ряд является нестационарным при решении временных рядов его необходимо привести к стационарному. Был принят следующий алгоритм решения: 

* Была определена сезонная составляющая по декомпозированному графику и удалена из временного ряда (удалена недельная составляющая);
* Удалили тренд с помощью обычного дифференцирования;
* Получили стационарный ряд. Построили вектор признаков. Признаками являлись предыдущие значения (лаги), скользящая средняя и календарные признаки;
* Поделили полученный датасет на тренировочную и тестовую выборки (тестовая выборка - последний 14 дней, как требовалось по заданию);
* Обучили три модели: линейную регрессию, дерево решений в регрессии и случайный лес в регрессии на тренировочной выборке;
* Далее были получены предсказания трёх моделей;
* Для корректной оценки модели необходимо было восстановить исходный ряд: сначала вернули удалённый тренд в прогноз;
* Далее вернули удалённую ранее сезонность;
* Наши предсказания приняли вид нестационарного ряда, построили графики, сопоставили предсказания с тестовой выборкой, определили качества моделей коэффициентом детерминации.

**ВЫВОД**: Наилучшая модель для данной задачи - это **дерево решений в регрессии**. Был получен коэффициент детерминации **0.921**. Данную модель считаю состоятельной, так как коэффициент R2 больше 0,7, что свидетельствует о хорошем качестве модели. 

* *Все результирующие графики с коэффицентами детерминации в самом конце тетради*
